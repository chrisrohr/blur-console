- content_for :title, 'Environment Status'

#zookeeper_wrapper
  - if @zookeeper
    .zookeeper{ :id => @zookeeper.id }
      #zookeeper
        %h2.title Zookeeper Information
        %table
          %tbody
            %tr
              %th Name:
              %td.value= @zookeeper.name
            %tr
              %th Connection:
              %td.value= @zookeeper.url
            %tr
              %th Status:
              %td.value
                - if @zookeeper.status == 1
                  .status.label.success
                    Online
                - else
                  .status.label.important
                    Offline
      #blur
        %h2.title Blur Status
        #controllers
          .blur_container
            - unless @zookeeper.controllers.empty?
              %h3.bottom-line= "Controllers(#{@zookeeper.controllers.length})"
              #controllers-placeholder
                - if @controller_nodes == 1
                  = "Controllers (blur version #{@zookeeper.controllers.first.blur_version}) :"
                - elsif @controller_nodes > 1
                  .warning
                    = "Controllers are not running the same blur version"
                %ul
                  - @zookeeper.controllers.sort_by{|c| [c.status, c.node_name]}.each do |controller|
                    %li<
                      = "#{controller.node_name}"
                      - if @controller_nodes > 1
                        = "(blur version #{controller.blur_version})"
                      - if controller.status == 1
                        .status.label.success
                          Online
                      - else
                        .status.label.important
                          Offline
                        = link_to 'Forget Offline Node', destroy_controller_path(@zookeeper, controller), :method=>:delete, :confirm=>'Are you sure you want to forget this node?'
            - else
              %h3.bottom-line Controllers
              #controllers-placeholder
                %p Not Available
        #shards
          .blur_container
            - unless @zookeeper.shards.empty?
              %h3.bottom-line= "Shards(#{@zookeeper.shards.length})"
              #shards-placeholder
                - if @shard_nodes == 1
                  = "Shards (blur version #{@zookeeper.shards.first.blur_version}) :"
                - elsif @shard_nodes > 1
                  .warning
                    = "Shards are not running the same blur version"
                %ul
                  - @zookeeper.clusters.sort_by{|c| c.name}.each do |cluster|
                    %li
                      = cluster.name
                      %ul
                        - cluster.shards.sort_by{|s| [s.status, s.node_name]}.each do |shard|
                          %li
                            = shard.node_name
                            - if @shard_nodes > 1
                              = "(blur version #{shard.blur_version})"
                            - if shard.status == 1
                              .status.label.success
                                Online
                            - else
                              .status.label.important
                                Offline
                              = link_to 'Forget Offline Node', destroy_shard_path(@zookeeper, shard), :method=>:delete, :confirm=>'Are you sure you want to forget this node?'
            - else
              %h3.bottom-line Shards
              %p Not Available

  - else
    No Zookeeper Instances Available
