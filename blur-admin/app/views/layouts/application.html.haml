!!!5
%html
  %head
    =csrf_meta_tag
    = javascript_include_tag 'application', 'routes'
    = yield(:javascript)
    = stylesheet_link_tag 'application', :media => "all" 
    - if @current_zookeeper.blank? && @zookeepers
      :javascript
        var Zookeeper = {};
        Zookeeper.instances = #{@zookeepers.collect{|z| {:id=>z.id, :name=>z.name}}.to_json}
    %title
      = yield(:title)
      | Blur Admin
  %body
    #root
      #top
        #hd
          #logo
            = link_to image_tag('blur_logo.png'), root_path
          - if flash
            #flash
              - flash.each do |type, message|
                -if type == :notice
                  .alert.alert-success{:class=>type}= message
                -elsif type == :error
                  .alert.alert-error{:class=>type}= message
                -else
                  .alert.alert-info{:class=>type}= message
          - if @current_zookeeper && @zookeepers
            #zookeeper_select
              = form_tag make_current_zookeeper_path, :id => 'change_current_zookeeper',
                                                      :method => :put,
                                                      :remote => :true do
                %b Current Zookeeper Instance:
                = select_tag( :id,
                  options_from_collection_for_select( @zookeepers, :id, :name, @current_zookeeper.id ),
                  :id => 'zookeeper_id' )
          #user_nav
            - if @current_user
              = "Welcome, "
              = link_to (@current_user.name || @current_user.username), @current_user
              - if session[:proof].blank?
                |
                = link_to "Log Out", logout_path

            - else
              = link_to "Register", new_user_path
              |
              = link_to "Log In", login_path

        #nav
          - if @current_user
            %ul
              - controller = params[:controller]
              - action = params[:action]

              %li{:class => controller == 'zookeepers' && action == 'index' && 'active'}
                = link_to 'Dashboard', root_path

              %li{:class => controller == 'zookeepers' && action == 'show_current' && 'active'}
                = link_to 'Environment Status', zookeeper_path, :id => 'env_link'

              %li{:class => controller == 'blur_tables' && 'active'}
                = link_to 'Blur Tables', blur_tables_path, :id => 'tables_link'

              %li{:class => controller == 'blur_queries' && 'active'}
                = link_to 'Blur Queries', blur_queries_path, :id => 'queries_link'

              - if can? :show, :search
                %li{:class => controller == 'search' && 'active'}
                  = link_to 'Search', search_path, :id => 'search_link'

              %li{:class => controller == 'hdfs' && 'active'}
                = link_to 'HDFS', hdfs_path

              - if can? :index, :users
                %li{:class => controller == 'users' && action == 'index' && 'active'}
                  = link_to 'Admin', users_path

      #bd.container
        = yield
    #ft{:class => footer_class(license)}
      #license
        %p
          = license_text(license)
      #company-info
        %p
          %a#page-help{:href => '#'} Help
          | Developed by 
          %a{:href => "http://www.nearinfinity.com"} Near Infinity
          | Version 0.6
#help-menu{:style => 'display: none', "data-controller" => params[:controller], "data-action" => params[:action]}